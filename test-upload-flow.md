# 文件上传后自动选择数据集功能测试

## 测试目标
验证当用户通过对话框上传文件后，系统能够自动选择对应的数据集到"当前数据集"下拉框中。

## 测试步骤

### 1. 初始状态检查
- [ ] 打开应用，进入对话分析页面
- [ ] 确认"当前数据集"下拉框显示"选择数据集"
- [ ] 确认左侧数据集列表为空或显示现有数据集

### 2. 通过对话框上传文件
- [ ] 在聊天输入框右侧点击回形针图标（上传文件按钮）
- [ ] 选择一个CSV或Excel文件
- [ ] 确认文件上传进度显示
- [ ] 确认上传成功提示

### 3. 验证自动选择功能
- [ ] 检查"当前数据集"下拉框是否自动选择了新上传的数据集
- [ ] 确认左侧数据集列表显示新上传的数据集
- [ ] 确认输入框占位符文本更新为"向 [数据集名称] 提问..."
- [ ] 确认欢迎消息更新为"数据集已准备就绪！"

### 4. 验证系统消息
- [ ] 检查聊天界面是否显示系统消息："数据集 [名称] 上传成功！包含 X 行数据，Y 个字段。"
- [ ] 确认是否自动发送了分析请求消息

### 5. 多会话测试
- [ ] 创建多个聊天会话
- [ ] 在其中一个会话中上传文件
- [ ] 确认只有当前活跃会话的数据集选择器被更新
- [ ] 其他会话的数据集选择器保持不变

### 6. 错误处理测试
- [ ] 尝试上传不支持的文件格式
- [ ] 确认显示错误提示
- [ ] 确认数据集选择器状态不变

## 预期结果
- 文件上传成功后，"当前数据集"下拉框应自动选择新上传的数据集
- 聊天界面应显示相应的系统消息和状态更新
- 用户体验应流畅，无需手动选择数据集

## 技术实现要点
1. 数据存储中的 `UploadDataset` 方法更新了多聊天存储
2. 聊天窗口组件监听数据存储变化，自动更新数据集选择器
3. 系统消息自动添加到活跃会话中
4. 错误处理确保上传失败时不影响现有状态
